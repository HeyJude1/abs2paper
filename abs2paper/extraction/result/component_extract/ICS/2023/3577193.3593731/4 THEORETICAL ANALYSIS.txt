4 THEORETICAL ANALYSIS
Because BEAM inverts ğ´ instead of ğ´, it is crucial to understand the errors that arise when solving ğ´ğ‘¥ = ğ‘ in finite-precision. First, the additive modifications guarantee that ğ´ and its block principal leading submatrices are non-singular, a prerequisite for the success of non-pivoted block-LU factorizations. Thus, this algorithm (without the Woodbury formula) computes a solution, ğ‘¥, that satisfies a nearby system,
( ğ´ + Î” ğ´) ğ‘¥ = (ğ‘ + Î”ğ‘), (3)
with
âˆ¥Î” ğ´âˆ¥ 2 â‰¤ ğœ‚ 2 ( ğ‘¥) âˆ¥ ğ´âˆ¥ 2 and âˆ¥Î”ğ‘ âˆ¥ 2 â‰¤ ğœ‚ 2 ( ğ‘¥) âˆ¥ğ‘ âˆ¥ 2 ; (4)
that is, ğœ‚ 2 ( ğ‘¥) is the normwise backward error for the spectral norm. Then, combining (3) with the definition of ğ´ from ( ) gives
(ğ´ + ğ‘€ ğ‘ˆ ğ‘€ Î£ ğ‘€ ğ‘‡ ğ‘‰ + Î” ğ´) ğ‘¥ = (ğ‘ + Î”ğ‘).
Thus, the backward error of ğ‘¥ for the original system ğ´ğ‘¥ = ğ‘ is
ğœ‚ 2 ( ğ‘¥) â‰¤ max âˆ¥ğ‘€ ğ‘ˆ ğ‘€ Î£ ğ‘€ ğ‘‡ ğ‘‰ + Î” ğ´âˆ¥ 2 âˆ¥ğ´âˆ¥ 2 , âˆ¥Î”ğ‘ âˆ¥ 2 âˆ¥ğ‘ âˆ¥ 2 â‰¤ Ï„ + ğœ‚ 2 ( ğ‘¥). (5)
Hence, the forward error of ğ‘¥ can be bounded with only Ï„, the backward stability of the block factorization, and the condition number of ğ´. Importantly, ğ´ need not be well conditioned. Furthermore, the convergence of iterative refinement is also ensured when those three values are sufficiently small . Note that (5) implies that Ï„ may directly contribute to the backward error when there are modifications but the Woodbury formula is not applied.
Unfortunately, an ill-conditioned ğ´ can still be problematic when using the Woodbury formula because its forward error directly perturbs the capacitance matrix and, thus, the correction. To help understand this condition number, we provide the following theorem, which states that if the tolerance, Ï„, is small relative to the reciprocal condition number of ğ´, the conditioning of ğ´ will be close to that of ğ´. Interestingly, the condition of this theorem ( Ï„ğœ… 2 (ğ´) â‰ª 1) appears related to the requirement implied by for the solution to have any digits of accuracy ( Ï„ğœ… 2 (ğ´) + ğœ‚ 2 ğœ… 2 (ğ´) â‰ª 1).
= Ï„ âˆ¥ğ´âˆ¥ 2 . If Ï„ğœ… 2 (ğ´) < 1, then ğœ… 2 ( ğ´) â‰¤ ğœ 1 (ğ´) + ğœ ğœ ğ‘› (ğ´) âˆ’ ğœ = ğœ… 2 (ğ´) 1 + Ï„ 1 âˆ’ Ï„ğœ… 2 (ğ´)
where ğœ 1 (ğ´) and ğœ ğ‘› (ğ´) denote the largest and smallest singular values, respectively, and ğœ… 2 (ğ´) = ğœ 1 (ğ´)/ğœ ğ‘› (ğ´).
Proof. By the triangle inequality,
ğœ 1 ( ğ´) â‰¤ ğœ 1 (ğ´) + ğœ and ğœ ğ‘› ( ğ´) â‰¥ ğœ ğ‘› (ğ´) âˆ’ ğœ . Suppose Ï„ğœ… 2 (ğ´) < 1, which implies ğœ ğ‘› (ğ´) âˆ’ ğœ > 0. Hence, ğœ… 2 ( ğ´) â‰¤ ğœ 1 (ğ´) + ğœ ğœ ğ‘› (ğ´) âˆ’ ğœ = ğœ 1 (ğ´) + Ï„ğœ 1 (ğ´) ğœ ğ‘› (ğ´) âˆ’ Ï„ğœ 1 (ğ´) = ğœ… 2 (ğ´) 1 + Ï„ 1 âˆ’ Ï„ğœ… 2 (ğ´)
. â–¡
When applying the Woodbury formula, we must also invert the capacitance matrix as per . Thus, its condition number is also crucial in the analysis of this method. We start by generalizing a lemma of Yip to the full version of the Woodbury formula. Lemma 4.2. Let âˆ¥â€¢âˆ¥ ğ‘ be any sub-multiplicative matrix norm. We denote the condition number with respect to the Moore-Penrose pseudoinverse by ğœ… + ğ‘ (ğ´) = âˆ¥ğ´âˆ¥ ğ‘ âˆ¥ğ´ + âˆ¥ ğ‘ . Suppose ğ´ = ğ´ + ğ‘ˆ Î£ğ‘‰ ğ‘‡ is nonsingular with ğ‘ˆ , ğ‘‰ having full column rank and Î£ being nonsingular. Then,
ğœ… ğ‘ (Î£ âˆ’1 âˆ’ ğ‘‰ ğ‘‡ ğ´ âˆ’1 ğ‘ˆ ) â‰¤ min ğœ… + ğ‘ (ğ‘ˆ ) 2 , ğœ… + ğ‘ (ğ‘‰ ğ‘‡ ) 2 ğœ… ğ‘ (Î£)ğœ… ğ‘ (ğ´ ğ´ âˆ’1 ) â‰¤ min ğœ… + ğ‘ (ğ‘ˆ ) 2 , ğœ… + ğ‘ (ğ‘‰ ğ‘‡ ) 2 ğœ… ğ‘ (Î£)ğœ… ğ‘ (ğ´)ğœ… ğ‘ ( ğ´).
Proof. Because we must bound the norm of the capacitance matrix, we start by rewriting its expression. Multiplying ğ´âˆ’ğ‘ˆ Î£ğ‘‰ ğ‘‡ = ğ´ on the left by Î£ âˆ’1 ğ‘ˆ + and on the right by ğ´ âˆ’1 ğ‘ˆ gives
(Î£ âˆ’1 âˆ’ ğ‘‰ ğ‘‡ ğ´ âˆ’1 ğ‘ˆ ) = Î£ âˆ’1 ğ‘ˆ + ğ´ ğ´ âˆ’1 ğ‘ˆ . (6)
We next seek a similar expression for its inverse. Note that,
ğ´ ğ´ âˆ’1 ğ‘ˆ = ( ğ´ âˆ’ ğ‘ˆ Î£ğ‘‰ ğ‘‡ ) ğ´ âˆ’1 ğ‘ˆ = ğ‘ˆ âˆ’ ğ‘ˆ Î£ğ‘‰ ğ‘‡ ğ´ âˆ’1 ğ‘ˆ .
So, the columns of ğ´ ğ´ âˆ’1 ğ‘ˆ are within the column space of ğ‘ˆ . Since ğ‘ˆğ‘ˆ + is an orthogonal projector onto that space , we have (ğ‘ˆğ‘ˆ + )ğ´ ğ´ âˆ’1 ğ‘ˆ = ğ´ ğ´ âˆ’1 ğ‘ˆ . Using this, we can verify that
(ğ‘ˆ + ğ´ğ´ âˆ’1 ğ‘ˆ Î£)(Î£ âˆ’1 ğ‘ˆ + ğ´ ğ´ âˆ’1 ğ‘ˆ ) = ğ¼ .
Combining this with gives the desired inverse:
(Î£ âˆ’1 âˆ’ ğ‘‰ ğ‘‡ ğ´ âˆ’1 ğ‘ˆ ) âˆ’1 = ğ‘ˆ + ğ´ğ´ âˆ’1 ğ‘ˆ Î£.
Hence, the condition number can be bounded as
ğœ… ğ‘ (Î£ âˆ’1 âˆ’ ğ‘‰ ğ‘‡ ğ´ âˆ’1 ğ‘ˆ ) = âˆ¥Î£ âˆ’1 ğ‘ˆ + ğ´ ğ´ âˆ’1 ğ‘ˆ âˆ¥ ğ‘ âˆ¥ğ‘ˆ + ğ´ğ´ âˆ’1 ğ‘ˆ Î£âˆ¥ ğ‘ â‰¤ ğœ… + ğ‘ (ğ‘ˆ ) 2 ğœ… ğ‘ (Î£)âˆ¥ğ´ ğ´ âˆ’1 âˆ¥ ğ‘ âˆ¥ ğ´ğ´ âˆ’1 âˆ¥ ğ‘ . A similar argument shows that ğœ… ğ‘ (Î£ âˆ’ ğ‘ˆ ğ´ âˆ’1 ğ‘‰ ğ‘‡ ) â‰¤ ğœ… + ğ‘ (ğ‘‰ ğ‘‡ ) 2 ğœ… ğ‘ (Î£)âˆ¥ğ´ ğ´ âˆ’1 âˆ¥ ğ‘ âˆ¥ ğ´ğ´ âˆ’1 âˆ¥ ğ‘ . â–¡
Using this lemma, the condition number for the capacitance matrix in the obvious form of the Woodbury formula is bounded by
ğœ… 2 (ğ‘€ âˆ’1 Î£ âˆ’ ğ‘€ ğ‘‡ ğ‘‰ ğ´ âˆ’1 ğ‘€ ğ‘ˆ ) â‰¤ ğœ… 2 (ğ‘€ Î£ )ğœ… 2 (ğ´ ğ´ âˆ’1 )
. As mentioned in Section 3, we instead formulate the Woodbury correction to get a tighter bound on the condition number:
ğœ… 2 (ğ¼ âˆ’ ğ‘€ Î£ ğ‘€ ğ‘‡ ğ‘‰ ğ´ âˆ’1 ğ‘€ ğ‘ˆ ) â‰¤ ğœ… 2 (ğ´ ğ´ âˆ’1 )
. The conditioning of this latter matrix can be further improved, particularly for the 2-norm. The following theorem shows that as long as neither ğ´ nor ğ´ are ill-conditioned, the capacitance matrix will have an excellent condition number.
âˆ¥ğ‘€ Î£ âˆ¥ 2 = ğœ. Additionally, let C = ğ¼ âˆ’ ğ‘€ Î£ ğ‘€ ğ‘‡ ğ‘‰ ğ´ âˆ’1 ğ‘€ ğ‘ˆ . Then, ğœ… 2 (C) â‰¤ (1 + ğœ âˆ¥ ğ´ âˆ’1 âˆ¥ 2 ) (1 + ğœ âˆ¥ğ´ âˆ’1 âˆ¥ 2 ).
If ğœ = Ï„ âˆ¥ğ´âˆ¥ 2 with Ï„ < 1, then we can simplify the bound to
ğœ… 2 (C) â‰¤ (1 + Ï„ 1âˆ’ Ï„ ğœ… 2 ( ğ´)) (1 + Ï„ğœ… 2 (ğ´)).
Proof. With ğ‘ˆ = ğ‘€ ğ‘ˆ , Î£ = ğ¼ , and
ğ‘‰ ğ‘‡ = ğ‘€ Î£ ğ‘€ ğ‘‡ ğ‘‰ , Lemma 4.2 gives the bound ğœ… 2 (C) â‰¤ âˆ¥ğ´ ğ´ âˆ’1 âˆ¥ 2 âˆ¥ ğ´ğ´ âˆ’1 âˆ¥ 2 . Since ğ´ = ğ´ âˆ’ ğ‘€ ğ‘ˆ ğ‘€ Î£ ğ‘€ ğ‘‡ ğ‘‰ and âˆ¥ğ‘€ ğ‘ˆ ğ‘€ Î£ ğ‘€ ğ‘‡ ğ‘‰ âˆ¥ 2 = ğœ, a little algebra shows that ğœ… 2 (C) â‰¤ (1 + ğœ âˆ¥ ğ´ âˆ’1 âˆ¥ 2 ) (1 + ğœ âˆ¥ğ´ âˆ’1 âˆ¥ 2 ). Suppose ğœ = Ï„ âˆ¥ğ´âˆ¥ 2 and Ï„ < 1. Then, âˆ¥ğ´âˆ¥ 2 = âˆ¥ ğ´ âˆ’ ğ‘€ ğ‘ˆ ğ‘€ Î£ ğ‘€ ğ‘‡ ğ‘‰ âˆ¥ 2 â‰¤ âˆ¥ ğ´âˆ¥ 2 + Ï„ âˆ¥ğ´âˆ¥ 2 , and so âˆ¥ğ´âˆ¥ 2 â‰¤ (1 âˆ’ Ï„) âˆ’1 âˆ¥ ğ´âˆ¥ 2 . Therefore, ğœ… 2 (C) â‰¤ (1 + Ï„ âˆ¥ğ´âˆ¥ 2 âˆ¥ ğ´ âˆ’1 âˆ¥ 2 ) (1 + Ï„ âˆ¥ğ´âˆ¥ 2 âˆ¥ğ´ âˆ’1 âˆ¥ 2 ) â‰¤ (1 + Ï„ 1âˆ’ Ï„ ğœ… 2 ( ğ´)) (1 + Ï„ğœ… 2 (ğ´)).
â–¡ After the backward error bound in and the theorems on key condition numbers, one major concern remains: how backward stable is the factorization of ğ´? To our knowledge, no analysis exists for block LU that would apply to Algorithm 1. The closest is by Demmel, Higham, and Schreiber , but the block LU they analyzed differs from our factorization in two primary ways. First, the diagonal blocks are factored with GEPP instead of the SVD. Second, the diagonal blocks of the lower block-triangular factor are identity matrices instead of singular vectors. Under reasonable assumptions, they proved that it computes a solution, ğ‘¥, to ğ´ğ‘¥ = ğ‘ such that
(ğ´ + Î”ğ´) ğ‘¥ ğ‘, âˆ¥ ğ‘¥ âˆ¥ max â‰¤ ğ‘ (ğ‘›)ğ‘¢ (âˆ¥ğ´âˆ¥ max + âˆ¥ ğ¿âˆ¥ max âˆ¥ ğ‘ˆ âˆ¥ max )
where ğ¿ and ğ‘ˆ are the computed block-triangular factors and ğ‘ (ğ‘›) is a constant dependent on ğ‘›. Thus, we expect the method to be backward stable when âˆ¥ ğ¿âˆ¥ max âˆ¥ ğ‘ˆ âˆ¥ max /âˆ¥ ğ´âˆ¥ max is small. For the general case, Demmel et al. proved that this ratio is at most
âˆ¥ ğ¿âˆ¥ max âˆ¥ ğ‘ˆ âˆ¥ max âˆ¥ğ´âˆ¥ max â‰¤ ğ‘›ğœŒ 3 NP ğœ… max (ğ´) (7)
where ğœŒ NP is the growth factor of ğ´ for GENP (i.e., the magnitude of the largest element that occurs in any Schur complement). While the previous analysis cannot guarantee the backward stability of BEAM's factorization, the similarity between the factorizations suggests such stability is likely. Furthermore, we expect a stronger version of ( ) can be proven for BEAM since the norms of the inverses of the diagonal blocks are bounded.