论文标题：Hybrid CUDA Unified Memory Management in Fully Homomorphic Encryption Workloads

关键词：homomorphic encryption，gpu，unified memory，hybrid，memory allocation

摘要：Fully homomorphic encryption (FHE) can utilize GPUs to accelerate arbitrary operations directly on encrypted data without decryption. Functions like bootstrapping which refresh noise accumulated on ciphertexts due to repeated operations require great amounts of GPU memory. Such functions cause out-of-memory (OOM) issues in retail GPUs with less than 8GB of VRAM, causing bootstrap to fail. Utilizing CUDA Unified Memory can alleviate OOM problems by allowing automatic page swapping from host to device memory. However, it usually comes with significant performance overheads. We devise a hybrid memory run-time that distinguishes between objects that are allocated asynchronously, or with managed memory. Our initial implementation was to statically determine in code the type of allocation method each GPU object would use. For a more general solution, we created a run-time scheduler which profiles and automatically determines the method of allocation each GPU object should use, without requiring static changes in library code. We then expanded upon this by creating a dynamic scheduler which forecasts the lifetime of future GPU objects without profiling. Our static method increases bootstrapping performance by ∼31% for large parameter sizes when memory is oversubscribed. Our profiling scheduler improves ResNet performance compared to manual swapping by ∼22%. Finally, our pure dynamic scheduler gives performance that is similar to our static solution, and up to 50% better performance in bootstrapping than the base unified case.