方法概述：  
1、方法名称: WCFR+ (Weighted Counterfactual Regret Minimization with Optimistic Variant) 和 PDCFR+ (Predictive Discounted CFR+)  

2、核心思想: 通过引入动态权重机制和预测优化技术，改进传统CFR算法的收敛速度。核心创新点包括：  
- **动态权重分配**：对近期迭代赋予更高权重（通过加权序列w和τ），以加速抵消早期迭代中错误决策的影响  
- **预测机制**：利用乐观OMD（Optimistic OMD）对未来反事实遗憾进行预测，提前调整策略  
- **双重加权**：独立设计损失函数和平均策略的加权序列，实现更灵活的收敛控制  

3、主要流程/组件  
**组件一：加权反事实遗憾计算**  
- 功能：在每次迭代t，计算加权瞬时遗憾 \( r_t^j = \langle x_t^j, \ell_t^j \rangle 1 - \ell_t^j \) 并乘以权重 \( w^t \)  
- 关键操作：累积加权总遗憾 \( R_{j,w}^T = \max_{x_j' \in \Delta_{n_j}} \sum_{t=1}^T w^t \langle \ell_t^j, x_t^j - x_j' \rangle \)  

**组件二：动态策略更新（OMD核心）**  
- 功能：使用带二次正则项的在线镜像下降法更新策略  
- 数学形式：\( x_{t+1}^j = \arg\min_{x_j' \in \mathbb{R}_{\geq 0}^{n_j}} -w^t r_t^j + \frac{1}{2\eta} \|x_j' - x_t^j\|_2^2 \)  
- 等效解释：随时间增加的学习率 \( \eta_t = \eta w^t \) 或递减的正则项强度  

**组件三：双序列加权平均策略生成**  
- 功能：使用独立权重序列τ构建收敛保证的平均策略  
- 计算公式：\( X_\tau^t = X_\tau^{t-1} + \tau^t \dot{x}^t \) ，归一化得 \( x_\tau^t = X_\tau^t / \|X_\tau^t\|_1 \)  

**组件四（PDCFR+特有）：预测式遗憾更新**  
- 功能：通过乐观OMD提前计算下一期预测遗憾 \( v_{t+1}^j \)  
- 更新规则：\( R_{t+1}^j = [R_t^j \cdot t^\alpha/(t^\alpha +1) + v_{t+1}^j]_+ \)  

**组件五（DCFR+继承机制）**  
- 功能：采用折扣因子控制历史影响  
- 典型操作：\( R_t^j = R_{t-1}^j \cdot (t-1)^\alpha / ((t-1)^\alpha +1) + [r_t^j]_+ \)  
- 策略权重衰减：\( X^t = X^{t-1} \cdot (\frac{t-1}{t})^\gamma + \dot{x}^t \)  

结构化关系说明：  
各组件通过以下逻辑链协同工作：(组件一)→(组件二/四)→(组件五)→(组件三)。首先计算加权瞬时遗憾，然后通过OMD或乐观OMD更新策略，接着应用折扣因子调整历史影响，最终生成具有理论收敛保证的加权平均策略。PDCFR+在WCFR+基础上增加预测机制（组件四），形成更快的响应闭环。