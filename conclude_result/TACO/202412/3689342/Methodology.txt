方法概述：

1、方法名称: Constraint-based Integrated Fusion and Data Layout Selection (CoNST)

2、核心思想: 通过约束求解系统自动确定张量数据布局的模态顺序和融合循环结构，以最小化中间张量的维度。该方法采用迭代策略，首先尝试将所有中间张量降为1维（l=1），若不可行则逐步增加维度限制，直到找到可行解。

3、主要流程/组件

组件/步骤一: 约束系统构建
- 为每个张量构建模态顺序约束变量dp_T,j
- 为每个收缩操作构建循环位置约束变量lp_i,k
- 为收缩树构建拓扑排序约束变量ap_i
- 添加模态顺序与循环顺序的一致性约束

组件/步骤二: SMT求解器验证
- 使用Z3 SMT求解器验证约束系统的可满足性
- 若可满足则提取解，否则增加维度限制l并重建系统

组件/步骤三: 生产者-消费者约束处理
- 对每对生产者-消费者添加特殊约束：
  生产者约束：确保最外层n-l个循环对应结果张量的索引
  消费者约束：确保消费者最外层n-l个循环与生产者匹配
  中间语句约束：确保位于生产者和消费者间的所有语句具有匹配的循环结构

组件/步骤四: 代码生成
- 将约束解转换为TACO的具体索引表示(concrete index notation)
- 生成包含forall和where结构的中间表示
- 最终输出高效的C代码实现

组件/步骤五: 维度缩减优化
- 通过循环融合减少中间张量的维度
- 对降维后的中间张量使用密集工作空间(dense workspace)表示
- 实现缓存局部性优化和访问开销降低