方法概述：  
1、方法名称: **Mentor架构**  
2、核心思想: 基于列式数据流（column-wise）的软硬件协同设计，通过流式内存访问和全流水线硬件架构优化稀疏-稠密矩阵乘法（SpMM）的性能。其核心直觉是通过重构输入矩阵的存储格式和访问模式，实现高效的数据复用、空间局部性和带宽利用率，同时利用分析模型平衡硬件资源与吞吐量。  

3、主要流程/组件  
**组件/步骤一：流式矩阵重构（Streaming Construction）**  
- **稠密矩阵优化**：采用行主序存储和分块策略（块大小为K×#PE），结合延迟参数c的周期延迟馈送（c-cycle delayed feeding），确保PE的高利用率并降低带宽需求。  
- **稀疏矩阵优化**：引入三种控制元素（Rest、Padding、Blocking）的新存储格式，消除RAW冲突并支持流式访问。Rest标记纤维结束，Padding增加非零元素间距以避免冲突，Blocking分区大矩阵以减少片上内存需求。  

**组件/步骤二：四阶段流水线架构（Column-Wise Pipeline）**  
1. **Read阶段**：  
   - *Read B模块*：以轮询方式将稠密矩阵B的元素分发给各PE，通过交叉开关降低硬件开销。  
   - *Read A模块*：广播稀疏矩阵A的非零值（idx和val数组）至所有PE，利用列式数据流避免全局访问。  
2. **Multiplication阶段**：各PE独立计算标量-向量积（A[m, rid] ⋅ B[rid, i]），通过完成信号（Rest/Blocking触发）控制无效输出（值为0，row-id为-1）。  
3. **Accumulation阶段**：双缓冲结构（double-scratchpad）交替存储部分结果并流式输出最终列C[∶, i]，避免流水线停顿。仲裁信号控制缓冲切换。  
4. **Write阶段**：以与Read B相同的带宽和延迟策略流式写回结果矩阵C至DRAM，保持计算与内存访问同步。  

**组件/步骤三：分析模型（Analytical Model）**  
- 根据稀疏矩阵特征（如平均每行非零数npr）动态配置硬件参数（如PE数量P= f(npr)⋅Eb），平衡资源与性能。延迟参数c=T−1（T=2^⌊log₂npr⌋），确保PE利用率与带宽效率的折衷。  

**关系总结**：流式重构为硬件提供优化的数据访问模式；四阶段流水线基于列式数据流实现高效计算；分析模型指导参数选择以适配不同输入特征，形成端到端的优化闭环。