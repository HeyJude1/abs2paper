方法概述：

1、方法名称: 性能嵌入与转移调优（Performance Embedding and Transfer Tuning）

2、核心思想: 通过神经网络将并行循环嵌套（parallel loop nests）的静态结构特征和动态性能特征编码为统一的低维嵌入向量，构建性能相似性空间。基于此空间，利用模糊匹配算法将已知优化方案从源循环嵌套迁移至具有相似嵌入的目标循环嵌套，实现跨程序的自动性能优化知识迁移。

3、主要流程/组件:
组件/步骤一: **并行循环嵌套表征**
- 功能: 定义并行循环嵌套的树状结构（包含嵌套映射、任务节点等），放宽对编译时已知循环范围和数据访问模式的限制，支持非数据无关型内核。

组件/步骤二: **静态编码**
- 功能: 将中间表示（SDFG状态数据流多图）转换为图结构特征，包括：
  - 访问节点：编码数据形状/类型/布局
  - Memlet边：通过中间节点表示数据访问模式（仿射/非仿射）
  - 基于图神经网络（GNN）生成节点嵌入，经注意力池化得到图嵌入

组件/步骤三: **动态编码**
- 功能: 收集19类硬件性能计数器（指令/缓存/带宽等），按线程统计最小值/最大值/均值等95维特征，经线性层映射为动态嵌入。

组件/步骤四: **联合建模**
- 功能: 拼接静态图嵌入和动态嵌入，通过MLP生成128维整体循环嵌套嵌入，并预测20种性能指标（运行时/IPC/带宽等）。

组件/步骤五: **转移调优算法**
- 功能: 
  1) 计算源变换子图的节点嵌入
  2) 计算目标循环嵌套的节点嵌入
  3) 构建二分图匹配问题（匈牙利算法求解）
  4) 实例化变换并验证有效性
  支持复杂变换（如分块）的类型约束和属性处理。